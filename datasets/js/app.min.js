function showInfo(e,a){allRows=_.sortBy(a.sheets("Completed Detailed Data").all(),"Department");var t=new URI,n=t.search(!0);if(n){var i=[];i.push(buildDepartmentFilter(n.department)),i.push(buildDatatypeFilter(n.datatype)),updateCards(allRows,_.compact(i))}else updateCards(allRows)}function updateCards(e,a){var a=a||[],t=$("#card-template").html(),n=Handlebars.compile(t);_.chain(e).filter(function(e){return _.all(a,function(a){return a(e)})}).map(function(e){e.free=e["Data is freely available online"],e.machine=e["Data is machine readable"],e.context=e["Context is provided"],e.bulk=e["Available in bulk"],e.fresh=e["Up-to-date"],e.incident=e["Incident-level data"],e.freeCaption=captions.free[e.free],e.machineCaption=captions.machine[e.machine],e.contextCaption=captions.context[e.context],e.bulkCaption=captions.bulk[e.bulk],e.freshCaption=captions.fresh[e.fresh],e.incidentCaption=captions.incident[e.incident];var a=n(e);$("#cards").append(a),$('[data-toggle="tooltip"]').tooltip()})}function buildDepartmentFilter(e){return e?function(a){return a.Department===e}:!1}function buildDatatypeFilter(e){return e?function(a){return a["Type of Data"]===e}:!1}function clearCards(){$("#cards").empty()}function filterByDepartment(e){clearCards(),updateCards(allRows,[buildDepartmentFilter(e)])}function resetSearch(){clearCards(),updateCards(allRows)}function filterByDatatype(e){clearCards(),updateCards(allRows,[buildDatatypeFilter(e)])}function filterByMachineReadable(e){clearCards(),updateCards(_.filter(allRows,function(a){return e?"Yes"===a["Data is machine readable"]:"No"===a["Data is machine readable"]}))}$(document).ready(function(){Tabletop.init({key:"1OhVbryeHBsPjJ3TjjVFlfM552pDKRjiUpTAXQJe9miA",callback:showInfo,parseNumbers:!0})});var allRows=[];